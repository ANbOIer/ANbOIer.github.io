<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>博客</title>
</head>
<body>
    <h1>我的博客</h1>

    <div id="articles">
        <!-- 动态生成博文列表 -->
    </div>

    <hr>

    <h3>添加博文</h3>
    <!-- IP 识别仅限特定 IP 可以增加博文 -->
    <form id="addForm">
        <input type="text" id="titleInput" placeholder="标题" required><br>
        <textarea id="contentInput" placeholder="内容" required></textarea><br>
        <input type="submit" value="提交">
    </form>

    <hr>

    <h3>删除博文</h3>
    <!-- IP 识别仅限特定 IP 可以删除博文 -->
    <form id="deleteForm">
        <input type="number" id="deleteIndex" placeholder="要删除的博文索引" required><br>
        <input type="submit" value="提交">
    </form>

    <script>
        // 存储博文数据的数组
        let articles = [];

        // 渲染博文列表
        function renderArticles() {
            const articlesDiv = document.getElementById('articles');
            articlesDiv.innerHTML = '';

            for (let i = 0; i < articles.length; i++) {
                const article = articles[i];
                const articleDiv = document.createElement('div');
                articleDiv.innerHTML = `
                    <h3>${article.title}</h3>
                    <p>${article.content}</p>
                    <hr>
                `;
                articlesDiv.appendChild(articleDiv);
            }
        }

        // 添加博文
        function addArticle(event) {
            event.preventDefault();

            const title = document.getElementById('titleInput').value;
            const content = document.getElementById('contentInput').value;

            // 添加 IP 识别逻辑
            const ipAddress = "{{ip-address}}"; // 替换为获取客户端 IP 的方法
            const allowedIPs = ['192.168.0.1', '10.0.0.1']; // 在此处定义允许的 IP 列表

            if (allowedIPs.includes(ipAddress)) {
                // IP 符合要求，可以添加博文
                articles.push({ title, content });
                renderArticles();
                document.getElementById('addForm').reset();
            } else {
                // IP 不符合要求，弹出提示
                alert('您没有权限添加博文！');
            }
        }

        // 删除博文
        function deleteArticle(event) {
            event.preventDefault();

            const index = document.getElementById('deleteIndex').value;

            // 添加 IP 识别逻辑（与添加博文类似）
            const ipAddress = "{{ip-address}}"; // 替换为获取客户端 IP 的方法
            const allowedIPs = ['192.168.1.6', '10.0.0.1']; // 在此处定义允许的 IP 列表

            if (allowedIPs.includes(ipAddress)) {
                // IP 符合要求，可以删除博文
                if (index >= 0 && index < articles.length) {
                    articles.splice(index, 1);
                    renderArticles();
                    document.getElementById('deleteForm').reset();
                } else {
                    alert('请输入有效的博文索引！');
                }
            } else {
                // IP 不符合要求，弹出提示
                alert('您没有权限删除博文！');
            }
        }

        // 监听添加博文表单提交事件
        document.getElementById('addForm').addEventListener('submit', addArticle);

        // 监听删除博文表单提交事件
        document.getElementById('deleteForm').addEventListener('submit', deleteArticle);
    </script>
</body>
</html>
